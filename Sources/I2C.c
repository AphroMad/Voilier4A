#include <I2C.h>

void I2C_Init(void) {
	BITMASK_SET(RCC->APB1ENR, RCC_APB1ENR_I2C1EN);
	BITMASK_SET(I2C1->CR1, I2C_CR1_START);
	BITMASK_SETV(I2C1->CR2, I2C_CR2_FREQ, I2C_CR2_FREQ_2);
	BITMASK_SETV(I2C1->CCR, I2C_CCR_CCR, 0x0002);
	
	BITMASK_SET(I2C1->CR1, I2C_CR1_PE);
}

uint8_t I2C_Read(void) {
	return BITMASK_GET(I2C1->DR, I2C_DR_DR);
}
